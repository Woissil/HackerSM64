#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"
#include "actors/group0.h"
#include "make_const_nonconst.h"
#include "levels/bitdw/header.h"

/* Fast64 begin persistent block [scripts] */
/* Fast64 end persistent block [scripts] */

const LevelScript level_bitdw_entry[] = {
	INIT_LEVEL(),
	LOAD_YAY0(0x07, _bitdw_segment_7SegmentRomStart, _bitdw_segment_7SegmentRomEnd), 
	LOAD_YAY0(0x05, _group11_yay0SegmentRomStart, _group11_yay0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group11_geoSegmentRomStart, _group11_geoSegmentRomEnd), 
	LOAD_YAY0(0x06, _group17_yay0SegmentRomStart, _group17_yay0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group17_geoSegmentRomStart, _group17_geoSegmentRomEnd), 
	LOAD_YAY0(0x08, _common0_yay0SegmentRomStart, _common0_yay0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	LOAD_YAY0(0xa, _bidw_skybox_yay0SegmentRomStart, _bidw_skybox_yay0SegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_12), 
	JUMP_LINK(script_func_global_18), 
	JUMP_LINK(script_func_global_1), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_03, geo_bitdw_0003C0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_04, geo_bitdw_0003D8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_05, geo_bitdw_0003F0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_06, geo_bitdw_000408), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_07, geo_bitdw_000420), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_08, geo_bitdw_000438), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_09, geo_bitdw_000450), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0A, geo_bitdw_000468), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0B, geo_bitdw_000480), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0C, geo_bitdw_000498), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0D, geo_bitdw_0004B0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0E, geo_bitdw_0004C8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_0F, geo_bitdw_0004E0), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_10, geo_bitdw_0004F8), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_11, geo_bitdw_000510), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_WARP_PIPE, warp_pipe_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_SQUARE_PLATFORM, geo_bitdw_000558), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_SEESAW_PLATFORM, geo_bitdw_000540), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_SLIDING_PLATFORM, geo_bitdw_000528), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_FERRIS_WHEEL_AXLE, geo_bitdw_000570), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_BLUE_PLATFORM, geo_bitdw_000588), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME4, geo_bitdw_0005A0), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME3, geo_bitdw_0005B8), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME2, geo_bitdw_0005D0), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE_FRAME1, geo_bitdw_0005E8), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_STAIRCASE, geo_bitdw_000600), 
	LOAD_MODEL_FROM_GEO(MODEL_NOTEBLOCK, noteblock_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_FLIPSWAP_PLATFORM_BORDER_MOP, Flipswap_Platform_Border_MOP_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_FLIPSWAP_PLATFORM_MOP, Flipswap_Platform_MOP_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_SANDBLOCK_MOP, SandBlock_MOP_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_SHRINKING_PLATFORM_BORDER_MOP, Shrinking_Platform_Border_MOP_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_SHRINKING_PLATFORM_MOP, Shrinking_Platform_MOP_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_SPRING_MOP, Spring_MOP_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_WARP_PIPE, warp_pipe_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_UPNDOWN, upndown_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_BITDW_IN_OUT_PLATFORM, bitdw_in_out_platform_geo), 
	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, bitdw_area_1),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_CASTLE, 0x01, 0xB0, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x01, 0xB1, WARP_NO_CHECKPOINT),
		MARIO_POS(0x01, 0, 4702, 804, -6822),
		OBJECT(MODEL_NONE, -1993, 7318, 6948, 0, 90, 0, (32 << 24), bhvTTCTreadmill),
		OBJECT(MODEL_NONE, 952, 7318, 6948, 0, -90, 0, (32 << 24) | (1 << 16), bhvTTCTreadmill),
		OBJECT(MODEL_NONE, 953, 7318, 5453, 0, 90, 0, (32 << 24), bhvTTCTreadmill),
		OBJECT(MODEL_NONE, -1992, 7318, 5453, 0, -90, 0, (32 << 24) | (1 << 16), bhvTTCTreadmill),
		OBJECT(MODEL_UPNDOWN, 6030, 7330, 4716, 0, -90, 0, (115 << 24) | (20 << 16) | (1 << 8), bhvUpDownObject),
		OBJECT(MODEL_UPNDOWN, 6689, 8159, -5100, 0, 0, 0, (30 << 24) | (15 << 16) | (2 << 8), bhvUpDownObject),
		OBJECT(MODEL_BITDW_IN_OUT_PLATFORM, 4552, 7561, -158, 0, -180, 0, (30 << 24) | (15 << 16) | (3 << 8) | (1), bhvInOutPlatform),
		OBJECT(MODEL_BITDW_IN_OUT_PLATFORM, 4821, 7888, -712, 0, 0, 0, (30 << 24) | (15 << 16) | (3 << 8), bhvInOutPlatform),
		OBJECT(MODEL_BITDW_IN_OUT_PLATFORM, 4552, 7716, -1723, 0, -180, 0, (30 << 24) | (15 << 16) | (3 << 8) | (1), bhvInOutPlatform),
		OBJECT(MODEL_BITDW_IN_OUT_PLATFORM, 4777, 7716, -2560, 0, 0, 0, (30 << 24) | (15 << 16) | (3 << 8), bhvInOutPlatform),
		OBJECT(MODEL_BITDW_IN_OUT_PLATFORM, -5033, 5625, -529, 0, -90, 0, (30 << 24) | (15 << 16) | (1 << 8), bhvInOutPlatform),
		OBJECT(MODEL_BITDW_IN_OUT_PLATFORM, -6306, 5625, -113, 0, 90, 0, (30 << 24) | (15 << 16) | (1 << 8) | (1), bhvInOutPlatform),
		OBJECT(0, 6722, 8645, -6340, 0, 0, 0,  0x10000, bhvAirborneDeathWarp),
		OBJECT(0, 6722, 8645, -6340, 0, 0, 0,  0x1000000, bhvBowserCourseRedCoinStar),
		OBJECT(194, -5901, 6935, -311, 0, 0, 0,  0x0, bhvCirclingAmp),
		OBJECT(0, -8744, 5725, -5785, 0, 0, 0,  0x0, bhvCoinFormation),
		OBJECT(0, -5687, 5440, -2464, 0, 90, 0,  0x0, bhvCoinFormation),
		OBJECT(0, -5895, 6875, -290, 0, 90, 0,  0x0, bhvCoinFormation),
		OBJECT(0, -4694, 7175, 5864, 0, 90, 0,  0x20000, bhvCoinFormation),
		OBJECT(0, -6374, 3067, -1326, 0, 90, 0,  0x20000, bhvCoinFormation),
		OBJECT(0, 3339, 7175, 6188, 0, 90, 0,  0x20000, bhvCoinFormation),
		OBJECT(137, -5956, 8535, 6960, 0, 0, 0,  0x50000, bhvExclamationBox),
		OBJECT(MODEL_FLIPSWAP_PLATFORM_MOP, -7044, 5905, -4111, 0, -23, 0,  0x0, bhvFlipswap_Platform_MOP),
		OBJECT(MODEL_FLIPSWAP_PLATFORM_MOP, -5974, 6295, -3440, 0, -28, 0,  0x0, bhvFlipswap_Platform_MOP),
		OBJECT(MODEL_FLIPSWAP_PLATFORM_MOP, -4974, 6715, -2953, 0, -33, 0,  0x0, bhvFlipswap_Platform_MOP),
		OBJECT(MODEL_FLIPSWAP_PLATFORM_MOP, -4752, 1000, -6951, 0, 0, 0,  0x0, bhvFlipswap_Platform_MOP),
		OBJECT(MODEL_FLIPSWAP_PLATFORM_MOP, -4752, 514, -7642, 0, -180, 0,  0x0, bhvFlipswap_Platform_MOP),
		OBJECT(MODEL_FLIPSWAP_PLATFORM_MOP, -4164, 250, -5600, 0, 125, 0,  0x0, bhvFlipswap_Platform_MOP),
		OBJECT(MODEL_FLIPSWAP_PLATFORM_MOP, -4738, 1451, -6265, 0, -180, 0,  0x0, bhvFlipswap_Platform_MOP),
		OBJECT(207, -5168, 155, -5256, 0, 0, 0,  0x0, bhvFloorSwitchHiddenObjects),
		OBJECT(220, 758, 640, -6769, 0, 0, 0,  0x0, bhvFlyGuy),
		OBJECT(220, -6425, 3130, -3217, 0, 0, 0,  0x0, bhvFlyGuy),
		OBJECT(220, 5519, 8410, -1163, 0, 0, 0,  0x0, bhvFlyGuy),
		OBJECT(0, -4694, 7175, 5864, 0, 90, 0,  0x0, bhvGoombaTripletSpawner),
		OBJECT(0, -6374, 3067, -1326, 0, 90, 0,  0x0, bhvGoombaTripletSpawner),
		OBJECT(0, 3339, 7175, 6188, 0, 90, 0,  0x0, bhvGoombaTripletSpawner),
		OBJECT(129, -1640, 90, -4777, 0, 0, 0,  0x0, bhvHiddenObject),
		OBJECT(129, -1640, 90, -4577, 0, 0, 0,  0x0, bhvHiddenObject),
		OBJECT(0, -1666, 1230, -595, 0, 0, 0,  0x0, bhvHiddenStar),
		OBJECT(0, 130, 930, -642, 0, 0, 0, (1 << 16), bhvHiddenStarTrigger),
		OBJECT(0, 1992, 930, 1183, 0, 0, 0, (1 << 16), bhvHiddenStarTrigger),
		OBJECT(0, 169, 930, 2969, 0, 0, 0, (1 << 16), bhvHiddenStarTrigger),
		OBJECT(0, -1679, 930, 1237, 0, 0, 0, (1 << 16), bhvHiddenStarTrigger),
		OBJECT(0, 208, 930, 1107, 0, 0, 0, (1 << 16), bhvHiddenStarTrigger),
		OBJECT(MODEL_NOTEBLOCK, -3944, 4072, -1375, 0, 0, 0,  0x5a0000, bhvNoteBlock),
		OBJECT(215, 6720, 539, -8577, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(215, -7210, 2850, -8486, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(215, -8746, 6514, -8211, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(215, -5664, 6060, -696, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(215, -7446, 6875, -310, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(215, -5061, 8369, 6619, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(215, -2016, 8060, 5465, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(215, 7413, 7639, 3627, 0, 0, 0,  0x0, bhvRedCoin),
		OBJECT(MODEL_SANDBLOCK_MOP, -5913, 2090, -3931, 0, 0, 0,  0x0, bhvSandblock_MOP),
		OBJECT(MODEL_SANDBLOCK_MOP, -6964, 2090, -3940, 0, 0, 0,  0x0, bhvSandblock_MOP),
		OBJECT(MODEL_SANDBLOCK_MOP, -5909, 2540, -3257, 0, 0, 0,  0x0, bhvSandblock_MOP),
		OBJECT(MODEL_SANDBLOCK_MOP, -6959, 2540, -3263, 0, 0, 0,  0x0, bhvSandblock_MOP),
		OBJECT(MODEL_SHRINKING_PLATFORM_MOP, 133, 720, -642, 0, 0, 0,  0x0, bhvShrinking_Platform_MOP),
		OBJECT(MODEL_SHRINKING_PLATFORM_MOP, 1991, 720, 1177, 0, 0, 0,  0x0, bhvShrinking_Platform_MOP),
		OBJECT(MODEL_SHRINKING_PLATFORM_MOP, 172, 720, 2968, 0, 0, 0,  0x0, bhvShrinking_Platform_MOP),
		OBJECT(MODEL_SHRINKING_PLATFORM_MOP, -1686, 720, 1216, 0, 0, 0,  0x0, bhvShrinking_Platform_MOP),
		OBJECT(MODEL_SHRINKING_PLATFORM_MOP, 208, 720, 1089, 0, 0, 0,  0x0, bhvShrinking_Platform_MOP),
		OBJECT(MODEL_SHRINKING_PLATFORM_MOP, -7669, 5580, -3460, 0, 0, 0,  0x0, bhvShrinking_Platform_MOP),
		OBJECT(MODEL_SPRING_MOP, -4064, 7175, -461, 0, -6, 0,  0x6e6e0000, bhvSpring_MOP),
		OBJECT(MODEL_WARP_PIPE, 6706, 8285, -6821, 0, 0, 0,  0x0, bhvWarpPipe),
		OBJECT(MODEL_NONE, 4702, 804, -6822, 0, 0, 0, 0x000A0000, bhvSpinAirborneWarp),
		TERRAIN(bitdw_area_1_collision),
		MACRO_OBJECTS(bitdw_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x28, SEQ_PMTTYD_MACHO_GRUBBA),
		TERRAIN_TYPE(TERRAIN_GRASS),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),
	FREE_LEVEL_POOL(),
	MARIO_POS(0x01, 0, 4702, 804, -6822),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};